import path from "path";

import sharp from "sharp";
// 간단한 SVG 아이콘 생성 (지도 핀 모양)
const svgIcon = `
<svg width="512" height="512" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="512" height="512" rx="128" fill="#000000"/>
  <path d="M256 128C198.125 128 151 175.125 151 233C151 280.875 191.375 320.25 256 320.25C320.625 320.25 361 280.875 361 233C361 175.125 313.875 128 256 128ZM256 288C218.75 288 188.5 257.75 188.5 220.5C188.5 183.25 218.75 153 256 153C293.25 153 323.5 183.25 323.5 220.5C323.5 257.75 293.25 288 256 288Z" fill="white"/>
  <path d="M256 352C229.5 352 208 373.5 208 400C208 412.5 218.5 423 231 423C243.5 423 254 412.5 254 400C254 387.5 264.5 377 277 377C289.5 377 300 387.5 300 400C300 426.5 278.5 448 252 448C225.5 448 204 426.5 204 400C204 355.8 239.8 320 284 320C328.2 320 364 355.8 364 400C364 462.75 313.25 514 250.5 514C187.75 514 137 462.75 137 400C137 346.25 180.75 303 234.5 303C246 303 256 313.5 256 325C256 336.5 246 347 234.5 347C197.25 347 167 377.25 167 414.5C167 451.75 197.25 482 234.5 482C271.75 482 302 451.75 302 414.5C302 400.5 313.5 389 327.5 389C341.5 389 353 400.5 353 414.5C353 474.25 304.25 523 244.5 523C184.75 523 136 474.25 136 414.5C136 352.75 187.75 301 249.5 301C285.75 301 316 331.25 316 367.5C316 383.75 302.75 397 286.5 397C270.25 397 257 383.75 257 367.5C257 351.25 270.25 338 286.5 338C318.25 338 344 363.75 344 395.5C344 427.25 318.25 453 286.5 453C254.75 453 229 427.25 229 395.5C229 379.25 242.25 366 258.5 366C274.75 366 288 379.25 288 395.5C288 439.75 252.25 475.5 208 475.5C163.75 475.5 128 439.75 128 395.5C128 335.25 176.75 286.5 237 286.5C297.25 286.5 346 335.25 346 395.5C346 469.75 285.75 529.5 211.5 529.5C137.25 529.5 77 469.75 77 395.5C77 309.25 146.75 239 233 239C319.25 239 389 309.25 389 395.5C389 487.25 314.25 562 222.5 562C130.75 562 56 487.25 56 395.5C56 283.75 146.75 189 258.5 189C370.25 189 461 283.75 461 395.5C461 519.25 360.25 620 236.5 620C112.75 620 12 519.25 12 395.5C12 249.25 130.75 131 277 131C423.25 131 542 249.25 542 395.5C542 563.25 405.25 700 237.5 700C69.75 700 0 563.25 0 395.5C0 195.25 162.75 33 363 33C563.25 33 726 195.25 726 395.5C726 627.25 537.25 816 305.5 816C73.75 816 0 627.25 0 395.5V395.5Z" fill="white"/>
</svg>
`;

async function generateIcons() {
  const publicDir = path.join(__dirname, "..", "public");

  // SVG를 버퍼로 변환
  const svgBuffer = Buffer.from(svgIcon);

  // 192x192 아이콘 생성
  await sharp(svgBuffer)
    .resize(192, 192)
    .png()
    .toFile(path.join(publicDir, "icon-192.png"));

  // 512x512 아이콘 생성
  await sharp(svgBuffer)
    .resize(512, 512)
    .png()
    .toFile(path.join(publicDir, "icon-512.png"));

  console.warn("PWA 아이콘이 생성되었습니다!");
}

generateIcons().catch(console.error);
